# Выбор и настройка мониторинга в системе

## Анализ
Сайт подключен к Яндекс Метрике вероятно означает покрытие самого сайта, апи сайта, бд сайта. 
Однако при интеграции MES Api метрики не добавили. Это означает, что мы не видим, например, нагрузки на MES Api, сколько сообщений лежит в RabbitMQ, количество ошибок и так далее.

## Мотивация
Главная мотивация для бизнеса в том, что мы хотим видеть, что заказы не теряются и MES Api не тормозит.
Также мы хотим видеть возникновение 500 ошибок до того, как их заметит пользователь, то есть сразу после релиза.
Метрики помогут выявить боттлнеки, описать проблематику и подготовить решение, которое улучшит пользовательский опыт.

## Выбор подхода к мониторингу
Для Shop Api и CRM Api выбираем подход RED, потому что это классические http сервисы.
RabbitMq - USE, так как нам важно видеть состояние очереди
MES Api - 4 золотых сигнала, т.к. в 4 сигналах добавляется насыщенность, и нам важно знать, насколько сервис перегружен.

## Метрики
RPS (Shop Api, CRM Api, Mes Api) - чтобы видеть нагрузку
Number of HTTP 5xx (Mes Api) - показатель ошибок
Response time (latency) для Mes Api - время ответа
Number of messages in RabbitMQ - если метрика растет, значит Mes не успевает обрабатывать заказы
CPU % (Shop Api, Mes Api) - потенциально нагруженные сервисы, важно проверять насыщенность

## План действий
Необходимо развернуть графану и прометеус. Можно в Yandex Cloud Managed Service.
Далее внедрить сбор метрик в коде, подключить экспорт метрик
В графане необходимо создать нужные дашборды. Обсудить как они будут выглядеть, объяснить коменде саппортов на что обращать внимание
Продумать систему алертов и четкий воркфлоу по всем возможным ошибкам